---
import Layout from '../layouts/Layout.astro';
import Header from './Header.astro';
import type { Language } from '../i18n/index';
import { t } from '../i18n/translations';

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  author?: string;
  lang: Language;
}

const { title, description, pubDate, author, lang } = Astro.props;
const translate = t(lang);

// 构建博客列表页链接
const blogListUrl = lang === 'en' ? '/blog' : `/${lang}/blog`;

// 格式化日期
const formattedDate = pubDate.toLocaleDateString(lang === 'zh-cn' ? 'zh-CN' : lang === 'zh-tw' ? 'zh-TW' : lang, {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<Layout title={title} lang={lang}>
  <Header lang={lang} />
  
  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <!-- 返回链接 -->
    <a 
      href={blogListUrl}
      class="inline-flex items-center text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 mb-8 transition-colors"
    >
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      {translate('blog.backToList')}
    </a>
    
    <!-- 文章头部 -->
    <header class="mb-10">
      <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 dark:text-white mb-4">
        {title}
      </h1>
      
      <div class="flex items-center text-gray-500 dark:text-gray-400 text-sm">
        <time datetime={pubDate.toISOString()}>
          {formattedDate}
        </time>
        {author && (
          <span class="mx-2">·</span>
          <span>{author}</span>
        )}
      </div>
    </header>
    
    <!-- 文章内容 -->
    <div class="prose prose-lg dark:prose-invert max-w-none
      prose-headings:text-gray-900 dark:prose-headings:text-white
      prose-p:text-gray-700 dark:prose-p:text-gray-300
      prose-a:text-blue-600 dark:prose-a:text-blue-400
      prose-strong:text-gray-900 dark:prose-strong:text-white
      prose-code:text-pink-600 dark:prose-code:text-pink-400
      prose-code:bg-gray-100 dark:prose-code:bg-gray-800
      prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded
      prose-pre:bg-gray-100 dark:prose-pre:bg-gray-800
      prose-ul:text-gray-700 dark:prose-ul:text-gray-300
      prose-ol:text-gray-700 dark:prose-ol:text-gray-300
      prose-li:text-gray-700 dark:prose-li:text-gray-300
      prose-blockquote:border-blue-500
      prose-blockquote:text-gray-700 dark:prose-blockquote:text-gray-300
    ">
      <slot />
    </div>
  </article>
</Layout>

<style is:global>
  /* Shiki 双主题切换 - 覆盖内联样式 */
  /* 亮色模式（默认）- 只覆盖背景色，文字颜色使用 Shiki 内联样式 */
  .astro-code {
    background-color: #f3f4f6 !important; /* bg-gray-100 */
  }
  
  /* 暗色模式 - 切换到深色主题 */
  .dark .astro-code {
    background-color: #1f2937 !important; /* bg-gray-800 */
  }
  .dark .astro-code span {
    color: var(--shiki-dark) !important;
  }
</style>
